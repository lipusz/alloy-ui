AUI.add("aui-tree-view",function(ab){var T=ab.Lang,aq=T.isBoolean,av=T.isString,q="boundingBox",d="children",a="container",Y="content",s="contentBox",R=".",ao="file",z="hitarea",P="icon",af="label",N="lastSelected",at="leaf",p="node",V="ownerTree",F="root",S="selectOnToggle",r=" ",f="tree",B="tree-node",K="tree-view",e="type",x="view",aw=function(){return Array.prototype.slice.call(arguments).join(r);},ak=function(A){return(A instanceof ab.TreeNode);},y=ab.getClassName,an=y(f,z),w=y(f,P),i=y(f,af),u=y(f,p,Y),l=y(f,F,a),ag=y(f,x,Y);var O=ab.Component.create({NAME:K,ATTRS:{type:{value:ao,validator:av},lastSelected:{value:null,validator:ak},io:{value:null},paginator:{value:null},selectOnToggle:{validator:aq,value:false}},AUGMENTS:[ab.TreeData],prototype:{CONTENT_TEMPLATE:"<ul></ul>",initializer:function(){var A=this;var ay=A.get(q);var L=A.get(s);A.set(a,L);ay.setData(K,A);},bindUI:function(){var A=this;A._delegateDOM();},renderUI:function(){var A=this;A._renderElements();},syncUI:function(){var A=this;A.refreshIndex();},registerNode:function(L){var A=this;L.set(V,A);ab.TreeView.superclass.registerNode.apply(this,arguments);},_createFromHTMLMarkup:function(L){var A=this;L.all("> li").each(function(aC){var aB=aC.one("> *").remove();var aA=aB.outerHTML();var aD=new ab.TreeNode({boundingBox:aC,label:aA});var az=aC.one("> ul");if(az){aD.set(at,false);aD.set(a,az);aD.render();A._createFromHTMLMarkup(az);}else{aD.render();}var ay=aC.get(c).get(c);var aE=ay.getData(B);if(!ab.instanceOf(aE,ab.TreeNode)){aE=ay.getData(K);}aE.appendChild(aD);});},_renderElements:function(){var A=this;var L=A.get(s);var ay=A.get(d);var az=A.get(e);var aA=y(f,az);L.addClass(ag);L.addClass(aw(aA,l));if(!ay.length){A._createFromHTMLMarkup(L);}},_delegateDOM:function(){var A=this;var L=A.get(q);L.delegate("click",ab.bind(A._onClickNodeEl,A),R+u);L.delegate("dblclick",ab.bind(A._onClickHitArea,A),R+w);L.delegate("dblclick",ab.bind(A._onClickHitArea,A),R+i);L.delegate("mouseenter",ab.bind(A._onMouseEnterNodeEl,A),R+u);L.delegate("mouseleave",ab.bind(A._onMouseLeaveNodeEl,A),R+u);},_onClickNodeEl:function(L){var A=this;var az=A.getNodeByChild(L.currentTarget);if(az){if(L.target.test(R+an)){az.toggle();if(!A.get(S)){return;}}if(!az.isSelected()){var ay=A.get(N);if(ay){ay.unselect();}az.select();}}},_onMouseEnterNodeEl:function(L){var A=this;var ay=A.getNodeByChild(L.currentTarget);if(ay){ay.over();}},_onMouseLeaveNodeEl:function(L){var A=this;var ay=A.getNodeByChild(L.currentTarget);if(ay){ay.out();}},_onClickHitArea:function(L){var A=this;var ay=A.getNodeByChild(L.currentTarget);if(ay){ay.toggle();}}}});ab.TreeView=O;var J=T.isNumber,ac="above",b="append",ae="below",am="block",ah="body",au="clearfix",aa="default",t="display",aj="down",v="drag",m="draggable",X="dragCursor",ap="dragNode",h="expanded",n="helper",ar="insert",D="offsetHeight",c="parentNode",ax="scrollDelay",M="state",ai="tree-drag-drop",al="up",I=ab.DD.DDM,ad=y(n,au),j=y(P),Z=y(f,v,n),o=y(f,v,n,Y),H=y(f,v,n,af),E=y(f,v,ar,ac),W=y(f,v,ar,b),G=y(f,v,ar,ae),k=y(f,v,M,b),Q=y(f,v,M,ar,ac),U=y(f,v,M,ar,ae),C='<div class="'+Z+'">'+'<div class="'+[o,ad].join(r)+'">'+'<span class="'+j+'"></span>'+'<span class="'+H+'"></span>'+"</div>"+"</div>";var g=ab.Component.create({NAME:ai,ATTRS:{helper:{value:null},scrollDelay:{value:100,validator:J}},EXTENDS:ab.TreeView,prototype:{direction:ae,dropAction:null,lastY:0,node:null,nodeContent:null,destructor:function(){var A=this;var L=A.get(n);if(L){L.remove(true);}A.eachChildren(function(az){if(az.get(m)){var ay=I.getDrag(az.get(s));if(ay){ay.destroy();}}},true);},bindUI:function(){var A=this;ab.TreeViewDD.superclass.bindUI.apply(this,arguments);A._bindDragDrop();},renderUI:function(){var A=this;ab.TreeViewDD.superclass.renderUI.apply(this,arguments);var L=ab.Node.create(C).hide();ab.one(ah).append(L);A.set(n,L);I.set(X,aa);},_createDrag:function(az){var L=this;if(!L.dragTimers){L.dragTimers=[];}if(!I.getDrag(az)){var A=L.dragTimers;var ay=50*A.length;var aA=setTimeout(function(){if(!I.getDrag(az)){var aB=new ab.DD.Drag({bubbleTargets:L,node:az,target:true}).plug(ab.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false,borderStyle:null}).plug(ab.Plugin.DDNodeScroll,{scrollDelay:L.get(ax),node:L.get(q)});aB.removeInvalid("a");}ab.Array.removeItem(A,aA);},ay);A.push(aA);}},_bindDragDrop:function(){var A=this;var L=A.get(q);A._createDragInitHandler=ab.bind(function(){A.eachChildren(function(ay){if(ay.get(m)){A._createDrag(ay.get(s));}},true);L.detach("mouseover",A._createDragInitHandler);},A);L.on("mouseover",A._createDragInitHandler);A.after("insert",ab.bind(A._afterAppend,A));A.after("append",ab.bind(A._afterAppend,A));A.on("drag:align",A._onDragAlign);A.on("drag:start",A._onDragStart);A.on("drop:exit",A._onDropExit);A.after("drop:hit",A._afterDropHit);A.on("drop:hit",A._onDropHit);A.on("drop:over",A._onDropOver);},_appendState:function(L){var A=this;A.dropAction=b;A.get(n).addClass(k);L.addClass(W);},_goingDownState:function(L){var A=this;A.dropAction=ae;A.get(n).addClass(U);L.addClass(G);},_goingUpState:function(L){var A=this;A.dropAction=ac;A.get(n).addClass(Q);L.addClass(E);},_resetState:function(L){var A=this;var ay=A.get(n);ay.removeClass(k);ay.removeClass(Q);ay.removeClass(U);if(L){L.removeClass(E);L.removeClass(W);L.removeClass(G);}},_updateNodeState:function(A){var aH=this;var aD=A.drag;var aA=A.drop;var L=aA.get(p);var aG=L.get(c);var aC=aD.get(p).get(c);var az=aG.getData(B);aH._resetState(aH.nodeContent);if(!aC.contains(aG)){var aI=L.get(D)/3;var ay=L.getY();var aF=ay+aI;var aE=ay+aI*2;var aB=aD.mouseXY[1];if((aB>ay)&&(aB<aF)){aH._goingUpState(L);}else{if(aB>aE){aH._goingDownState(L);}else{if((aB>aF)&&(aB<aE)){if(az&&!az.isLeaf()){aH._appendState(L);}else{if(aH.direction===al){aH._goingUpState(L);}else{aH._goingDownState(L);}}}}}}aH.nodeContent=L;},_afterAppend:function(L){var A=this;var ay=L.tree.node;if(ay.get(m)){A._createDrag(ay.get(s));}},_afterDropHit:function(aA){var A=this;var aC=A.dropAction;var aB=aA.drag.get(p).get(c);
var ay=aA.drop.get(p).get(c);var aD=ay.getData(B);var az=aB.getData(B);var L=A.getEventOutputMap(A);L.tree.dropNode=aD;L.tree.dragNode=az;if(aC===ac){aD.insertBefore(az);A.bubbleEvent("dropInsert",L);}else{if(aC===ae){aD.insertAfter(az);A.bubbleEvent("dropInsert",L);}else{if(aC===b){if(aD&&!aD.isLeaf()){aD.appendChild(az);if(!aD.get(h)){aD.expand();}A.bubbleEvent("dropAppend",L);}}}}A._resetState(A.nodeContent);A.bubbleEvent("drop",L);A.dropAction=null;},_onDragAlign:function(ay){var A=this;var L=A.lastY;var az=ay.target.lastXY[1];if(az!==L){A.direction=(az<L)?al:aj;}A.lastY=az;},_onDragStart:function(aB){var A=this;var az=aB.target;var aD=az.get(p).get(c);var ay=aD.getData(B);var aC=A.get(N);if(aC){aC.unselect();}ay.select();var aA=A.get(n);var L=aA.one(R+H);aA.setStyle(t,am).show();L.html(ay.get(af));az.set(ap,aA);},_onDropOver:function(L){var A=this;A._updateNodeState(L);},_onDropHit:function(L){var A=L.drop.get(p).get(c);var ay=A.getData(B);if(!ak(ay)){L.preventDefault();}},_onDropExit:function(){var A=this;A.dropAction=null;A._resetState(A.nodeContent);}}});ab.TreeViewDD=g;},"@VERSION@",{skinnable:true,requires:["aui-tree-node","dd-drag","dd-drop","dd-proxy"]});